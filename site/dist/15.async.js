(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[15],{KVKv:function(e,t,a){e.exports={tableList:"antd-pro-pages-settings-my-tableList",tableListOperator:"antd-pro-pages-settings-my-tableListOperator",tableListForm:"antd-pro-pages-settings-my-tableListForm",submitButtons:"antd-pro-pages-settings-my-submitButtons"}},TE24:function(e,t,a){"use strict";var l=a("TqRt"),r=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("IzEo");var d=l(a("bx4M"));a("Awhp");var n=l(a("KrTs")),i=l(a("pVnL"));a("+L6B");var u=l(a("2/Rp")),o=l(a("lwsE")),s=l(a("W8MJ")),c=l(a("a1gu")),f=l(a("Nsbk")),p=l(a("7W2i"));a("2qtc");var m=l(a("kLXV"));a("sRBo");var h=l(a("kaz8"));a("iQDF");var b=l(a("+eQT"));a("giR+");var v=l(a("fyUT")),y=l(a("MVZn"));a("y8nQ");var g=l(a("Vl3Y"));a("5NDa");var V,E,_,k,w,M=l(a("5rEg")),C=r(a("q1tI")),q=a("MuoO"),D=l(a("wd/R")),F=l(a("CkN6")),x=l(a("zHco")),S=a("+n12"),L=l(a("KVKv")),U=M.default.Search,R=g.default.Item,Y=function(e){return Object.keys(e).map(function(t){return e[t]}).join(",")},O=["default","processing","success","error"],I=["\u5173\u95ed","\u88ab\u91cd\u7f6e","\u6b63\u5e38","\u5f02\u5e38"],T=g.default.create()(function(e){var t=e.modalVisible,a=e.form,l=e.handleAdd,r=e.handleModalVisible,d=e.currentUser,n=d.email.split("@"),i=n[n.length-1],u=function(){a.validateFields(function(e,t){if(!e){a.resetFields();var r=t.date_of_birth.format("YYYY-MM-DD"),d="".concat(t.email,"@").concat(i),n=(0,y.default)({},t,{date_of_birth:r,email:d});l(n)}})};return C.default.createElement(m.default,{destroyOnClose:!0,title:"\u65b0\u5efa\u7528\u6237",visible:t,onOk:u,onCancel:function(){return r()}},C.default.createElement(R,{key:"name",labelCol:{span:5},wrapperCol:{span:15},label:"\u540d\u5b57"},a.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}]})(C.default.createElement(M.default,{placeholder:"\u8bf7\u8f93\u5165"}))),C.default.createElement(R,{key:"email",labelCol:{span:5},wrapperCol:{span:15},label:"\u7528\u6237\u540d/email"},a.getFieldDecorator("email",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}]})(C.default.createElement(M.default,{placeholder:"\u8bf7\u8f93\u5165",addonAfter:"@".concat(i)}))),C.default.createElement(R,{key:"quota",labelCol:{span:5},wrapperCol:{span:15},label:"\u53ef\u7528\u7a7a\u95f4",extra:(0,S.formatBytes)(a.getFieldValue("quota"))},a.getFieldDecorator("quota",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c111024"}],initialValue:1024})(C.default.createElement(v.default,{placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c111024",min:1024,style:{width:"100%"}}))),C.default.createElement(R,{key:"date_of_birth",labelCol:{span:5},wrapperCol:{span:15},label:"\u751f\u65e5"},a.getFieldDecorator("date_of_birth",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ed6\u7684\u751f\u65e5"}]})(C.default.createElement(b.default,{placeholder:"\u8bf7\u8f93\u5165\u4ed6\u7684\u751f\u65e5",style:{width:"100%"}}))),C.default.createElement(R,{key:"is_active",labelCol:{span:5},wrapperCol:{span:15},label:"\u662f\u5426\u53ef\u7528"},a.getFieldDecorator("is_active",{rules:[{required:!0,message:"\u8bf7\u8bbe\u7f6e\u7528\u6237\u72b6\u6001"}]})(C.default.createElement(h.default,{placeholder:"\u8bf7\u8bbe\u7f6e\u7528\u6237\u72b6\u6001"}))))}),A=(V=g.default.create(),V(E=function(e){function t(e){var a;return(0,o.default)(this,t),a=(0,c.default)(this,(0,f.default)(t).call(this,e)),a.handleNext=function(){var e=a.props,t=e.form,l=e.handleUpdate,r=a.state.formVals;t.validateFields(function(e,t){if(!e){var d=(0,y.default)({},r,t),n=d.date_of_birth.format("YYYY-MM-DD");a.setState({formVals:(0,y.default)({},d,{date_of_birth:n})},function(){l((0,y.default)({},d,{date_of_birth:n}))})}})},a.state={formVals:{name:e.values.name,email:e.values.email,id:e.values.id,quota:e.values.quota,date_of_birth:e.values.date_of_birth,is_active:e.values.is_active}},a.formLayout={labelCol:{span:7},wrapperCol:{span:13}},a}return(0,p.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.updateModalVisible,l=t.handleUpdateModalVisible,r=t.form,d=this.state.formVals;return C.default.createElement(m.default,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u89c4\u5219\u914d\u7f6e",visible:a,footer:[C.default.createElement(u.default,{key:"cancel",onClick:function(){return l()}},"\u53d6\u6d88"),C.default.createElement(u.default,{key:"submit",type:"primary",onClick:function(){return e.handleNext()}},"\u5b8c\u6210")],onCancel:function(){return l()}},C.default.createElement(R,(0,i.default)({key:"name"},this.formLayout,{label:"\u540d\u5b57"}),r.getFieldDecorator("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}],initialValue:d.name})(C.default.createElement(M.default,{placeholder:"\u8bf7\u8f93\u5165"}))),C.default.createElement(R,(0,i.default)({key:"email"},this.formLayout,{label:"\u7528\u6237\u540d/email"}),r.getFieldDecorator("email",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u89c4\u5219\u540d\u79f0\uff01"}],initialValue:d.email})(C.default.createElement(M.default,{placeholder:"\u8bf7\u8f93\u5165",disabled:!0}))),C.default.createElement(R,(0,i.default)({key:"quota"},this.formLayout,{label:"\u53ef\u7528\u7a7a\u95f4",extra:(0,S.formatBytes)(r.getFieldValue("quota")||d.quota)}),r.getFieldDecorator("quota",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u81f3\u5c111024"}],initialValue:d.quota})(C.default.createElement(v.default,{placeholder:"\u8bf7\u8f93\u5165\u81f3\u5c111024",min:1024,style:{width:"100%"}}))),C.default.createElement(R,(0,i.default)({key:"date_of_birth"},this.formLayout,{label:"\u751f\u65e5"}),r.getFieldDecorator("date_of_birth",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u4ed6\u7684\u751f\u65e5"}],initialValue:(0,D.default)(d.date_of_birth)})(C.default.createElement(b.default,{placeholder:"\u8bf7\u8f93\u5165\u4ed6\u7684\u751f\u65e5",style:{width:"100%"}}))),C.default.createElement(R,(0,i.default)({key:"is_active"},this.formLayout,{label:"\u662f\u5426\u53ef\u7528"}),r.getFieldDecorator("is_active",{rules:[{required:!0,message:"\u8bf7\u8bbe\u7f6e\u7528\u6237\u72b6\u6001"}],initialValue:d.is_active})(C.default.createElement(h.default,{placeholder:"\u8bf7\u8bbe\u7f6e\u7528\u6237\u72b6\u6001"}))))}}]),t}(C.PureComponent))||E),B=(_=(0,q.connect)(function(e){var t=e.virtual,a=e.user,l=e.loading;return{virtual:t,currentUser:a.currentUser,loading:l.models.virtual}}),k=g.default.create(),_(w=k(w=function(e){function t(){var e,a;(0,o.default)(this,t);for(var l=arguments.length,r=new Array(l),d=0;d<l;d++)r[d]=arguments[d];return a=(0,c.default)(this,(e=(0,f.default)(t)).call.apply(e,[this].concat(r))),a.state={modalVisible:!1,updateModalVisible:!1,selectedRows:[],search:{},stepFormValues:{}},a.columns=[{title:"\u7528\u6237\u540d\u79f0",dataIndex:"email"},{title:"\u540d\u5b57",dataIndex:"name"},{title:"\u53ef\u7528\u7a7a\u95f4",dataIndex:"quota",sorter:!0,align:"right",render:function(e){return(0,S.formatBytes)(e)},needTotal:!0},{title:"\u72b6\u6001",dataIndex:"status",filters:[{text:I[0],value:0},{text:I[1],value:1},{text:I[2],value:2},{text:I[3],value:3}],render:function(e){return C.default.createElement(n.default,{status:O[e],text:I[e]})}},{title:"\u4e0a\u6b21\u767b\u5f55\u65f6\u95f4",dataIndex:"last_login",sorter:!0,render:function(e){return C.default.createElement("span",null,(0,D.default)(e).format("YYYY-MM-DD HH:mm:ss"))}},{title:"\u64cd\u4f5c",render:function(e,t){return C.default.createElement("a",{onClick:function(){return a.handleUpdateModalVisible(!0,t)}},"\u4fee\u6539")}}],a.handleStandardTableChange=function(e,t,l){var r=a.props.dispatch,d=a.state.search,n=Object.keys(t).reduce(function(e,a){var l=(0,y.default)({},e);return l[a]=Y(t[a]),l},{}),i=(0,y.default)({page:e.current,pageSize:e.pageSize,search:d},n);l.field&&(i.sorter="".concat(l.field,"_").concat(l.order)),r({type:"virtual/fetch",payload:i})},a.handleDelete=function(){var e=a.props.dispatch,t=a.state.selectedRows;t&&e({type:"virtual/remove",payload:{key:t.map(function(e){return e.id})},callback:function(){a.setState({selectedRows:[]})}})},a.handleSelectRows=function(e){a.setState({selectedRows:e})},a.handleSearch=function(e){var t=a.props.dispatch;t({type:"virtual/fetch",payload:{search:e}}),a.setState({search:e})},a.handleModalVisible=function(e){a.setState({modalVisible:!!e})},a.handleUpdateModalVisible=function(e,t){a.setState({updateModalVisible:!!e,stepFormValues:t||{}})},a.handleAdd=function(e){var t=a.props.dispatch;t({type:"virtual/add",payload:e}),a.handleModalVisible()},a.handleUpdate=function(e){var t=a.props.dispatch;t({type:"virtual/update",payload:e}),a.handleUpdateModalVisible()},a}return(0,p.default)(t,e),(0,s.default)(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"virtual/fetch"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.virtual,l=t.loading,r=t.currentUser,n=this.state,o=n.selectedRows,s=n.modalVisible,c=n.updateModalVisible,f=n.stepFormValues,p={handleAdd:this.handleAdd,handleModalVisible:this.handleModalVisible},m={handleUpdateModalVisible:this.handleUpdateModalVisible,handleUpdate:this.handleUpdate};return C.default.createElement(x.default,{title:"\u7528\u6237\u7ba1\u7406"},C.default.createElement(d.default,{bordered:!1},C.default.createElement("div",{className:L.default.tableList},C.default.createElement("div",{className:L.default.tableListOperator},C.default.createElement(u.default,{icon:"plus",type:"primary",onClick:function(){return e.handleModalVisible(!0)}},"\u65b0\u5efa"),C.default.createElement(U,{placeholder:"\u641c\u7d22",onSearch:function(t){return e.handleSearch(t)},style:{width:200,marginRight:10}}),o.length>0&&C.default.createElement(u.default,{onClick:this.handleDelete},"\u5220\u9664")),C.default.createElement(F.default,{selectedRows:o,rowKey:"id",loading:l,data:a,columns:this.columns,onSelectRow:this.handleSelectRows,onChange:this.handleStandardTableChange}))),C.default.createElement(T,(0,i.default)({},p,{modalVisible:s,currentUser:r})),f&&Object.keys(f).length?C.default.createElement(A,(0,i.default)({},m,{updateModalVisible:c,values:f})):null)}}]),t}(C.PureComponent))||w)||w),N=B;t.default=N}}]);