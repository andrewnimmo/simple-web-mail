(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{C0Oh:function(e,t,a){"use strict";var n=a("284h"),l=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=l(a("lwsE")),o=l(a("W8MJ")),u=l(a("a1gu")),i=l(a("Nsbk")),d=l(a("7W2i")),c=l(a("q1tI"));a("GHf4");var f=n(a("rmP6")),s=a("Khnr"),h=l(a("bABQ"));a("91UR"),f.Quill.register("modules/imageResize",h.default),f.Quill.register("modules/imageDrop",s.ImageDrop);var p=function(e){function t(e){var a;return(0,r.default)(this,t),a=(0,u.default)(this,(0,i.default)(t).call(this,e)),a.attachQuillRefs=function(){"function"===typeof a.reactQuillRef.getEditor&&(a.quillRef=a.reactQuillRef.getEditor())},a.handleChange=function(e){var t=a.props,n=t.onChange,l=t.onCanPost;a.setState({value:e}),n&&!l&&n(e)},a.handleFocus=function(){var e=a.props.onCanPost;e&&e(!1)},a.handleBlur=function(){var e=a.props,t=e.onChange,n=e.onCanPost,l=a.state.value;if(t&&n){var r=a.quillRef.getText();t(l,r),n(!0)}},a.quillRef=null,a.reactQuillRef=null,a.state={value:e.data||"",modules:{toolbar:[[{header:[1,2,!1]}],["bold","italic","underline","strike","blockquote",{color:[]}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],["link","image","code-block"],["clean"]],history:{delay:2500,userOnly:!0},imageDrop:!0,syntax:!0,imageResize:{parchment:f.Quill.import("parchment")}}},a}return(0,d.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.attachQuillRefs()}},{key:"componentDidUpdate",value:function(){this.attachQuillRefs()}},{key:"render",value:function(){var e=this,t=this.state,a=t.value,n=t.modules;return c.default.createElement(f.default,{value:a,ref:function(t){e.reactQuillRef=t},onChange:this.handleChange,modules:n,onFocus:this.handleFocus,onBlur:this.handleBlur,placeholder:"\u7b80\u5355\u63cf\u8ff0\u4e0b\u4f60\u7684\u95ee\u9898",style:{background:"#ffffff",lineHeight:1.5}})}}]),t}(c.default.Component);t.default=p},"H/gq":function(e,t,a){"use strict";var n=a("TqRt"),l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("B9cy");var r=n(a("Ol7k"));a("IzEo");var o=n(a("bx4M"));a("DZo9");var u=n(a("8z0m"));a("+L6B");var i=n(a("2/Rp"));a("Pwec");var d=n(a("CtXQ"));a("5NDa");var c=n(a("5rEg"));a("OaEy");var f=n(a("2fM7")),s=n(a("RIqP")),h=n(a("MVZn")),p=n(a("lwsE")),m=n(a("W8MJ")),v=n(a("a1gu")),g=n(a("Nsbk")),y=n(a("7W2i"));a("y8nQ");var C,b,E,w=n(a("Vl3Y")),S=l(a("q1tI")),k=a("MuoO"),_=n(a("zHco")),R=n(a("C0Oh")),x=n(a("M1D9")),P=w.default.Item,M=/[\w!#$%&'*+/=?^_`{|}~-]+(?:\.[\w!#$%&'*+/=?^_`{|}~-]+)*@(?:[\w](?:[\w-]*[\w])?\.)+[\w](?:[\w-]*[\w])?$/,D=(C=(0,k.connect)(function(e){var t=e.frend,a=e.mail,n=e.loading;return{frend:t,current:a.current,submitting:n.effects["mail/sendMail"]}}),b=w.default.create(),C(E=b(E=function(e){function t(){var e,a;(0,p.default)(this,t);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return a=(0,v.default)(this,(e=(0,g.default)(t)).call.apply(e,[this].concat(l))),a.state={canPost:!1,fileList:[],currentFrend:"to",content_html:"",content_text:"",data:'<br /><br /><br /><br /><br /><br /><br /><br /><br /><p><span style="color: rgb(187, 187, 187);">\u6765\u81eaMail Box Web</span></p>'},a.handleSubmit=function(e){var t=a.props,n=t.dispatch,l=t.form,r=a.state,o=r.fileList,u=r.content_html,i=r.content_text;e.preventDefault(),l.validateFieldsAndScroll(function(e,t){e||n({type:"mail/sendMail",payload:(0,h.default)({},t,{file_list:o,content_html:u,content_text:i})})})},a.handleChangeTo=function(e,t){var n=a.props.form,l=a.state.currentFrend,r=n.setFieldsValue,o=n.getFieldValue,u=o(l)||[];if(M.test(e)){var i=u;"add"===t?i=Array.isArray(e)?(0,s.default)(u).concat((0,s.default)(e)):(0,s.default)(u).concat([e]):"del"===t&&(i=Array.isArray(e)?u.filter(function(t){return-1===e.indexOf(t)}):u.filter(function(t){return t!==e}));var d=i.filter(function(e,t,a){return a.indexOf(e)===t});"to"===l?r({to:d}):"cc"===l&&r({cc:d})}},a.handleCanPost=function(e){a.setState({canPost:e})},a.handleChangeContent=function(e,t){a.setState({content_html:e,content_text:t})},a.handleSaveDraft=function(){var e=a.props,t=e.dispatch,n=e.form,l=a.state,r=l.fileList,o=l.content_html,u=l.content_text,i=n.getFieldsValue();t({type:"mail/saveDraft",payload:(0,h.default)({},i,{file_list:r,content_html:o,content_text:u})})},a.handleChange=function(e){var t=e.fileList;t=t.map(function(e){return e.response&&(e.url=e.response.file),e}),t=t.filter(function(e){return!e.response||"error"!==e.response.status}),a.setState({fileList:t})},a}return(0,y.default)(t,e),(0,m.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,n=t.current,l=a.getFieldDecorator,s=this.state,h=s.canPost,p=s.data,m={name:"file",action:"/api/upload/",headers:{authorization:"authorization-text"},onChange:this.handleChange};return S.default.createElement(_.default,null,S.default.createElement(r.default,null,S.default.createElement(r.default.Content,null,S.default.createElement(o.default,{bordered:!1,style:{minHeight:600}},S.default.createElement(w.default,{onSubmit:this.handleSubmit},S.default.createElement(P,{label:"\u6536\u4ef6\u4eba",labelCol:{span:2},wrapperCol:{span:22}},l("to",{rules:[{required:!0,message:"\u5fc5\u987b\u67091\u4e2a\u6536\u4ef6\u4eba"},{max:50,type:"array",message:"\u6700\u591a\u53ea\u80fd\u540c\u65f6\u53d1\u7ed950\u4e2a\u4eba"},function(e,t,a){var n=[];t&&t.every(function(t){return!!M.test(t)||(n.push(new Error("".concat(t,"\u4e0d\u662f\u5408\u6cd5email"),e.field)),!1)}),a(n)}],initialValue:n.to})(S.default.createElement(f.default,{mode:"tags",placeholder:"\u6536\u4ef6\u4ebaemail",style:{width:"100%"},tokenSeparators:[","],onFocus:function(){return e.setState({currentFrend:"to"})}}))),S.default.createElement(P,{label:"\u6284\u9001\u7ed9",labelCol:{span:2},wrapperCol:{span:22}},l("cc",{rules:[function(e,t,a){var n=[];t&&t.every(function(t){return!!M.test(t)||(n.push(new Error("".concat(t,"\u4e0d\u662f\u5408\u6cd5email"),e.field)),!1)}),a(n)}],initialValue:n.cc})(S.default.createElement(f.default,{mode:"tags",placeholder:"\u6536\u4ef6\u4ebaemail",style:{width:"100%"},tokenSeparators:[","],onFocus:function(){return e.setState({currentFrend:"cc"})}}))),S.default.createElement(P,{label:"\u4e3b\u9898",labelCol:{span:2},wrapperCol:{span:22}},l("subject",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u4e3b\u9898"}],initialValue:n.subject})(S.default.createElement(c.default,{placeholder:"\u90ae\u4ef6\u4e3b\u9898"}))),S.default.createElement(P,{label:"\u5185\u5bb9",labelCol:{span:2},wrapperCol:{span:22}},l("content_html",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u90ae\u4ef6\u5185\u5bb9"}]})(S.default.createElement(R.default,{data:n.content_html||p,isEditor:!0,onCanPost:this.handleCanPost,canPost:h,onChange:this.handleChangeContent}))),S.default.createElement(P,{wrapperCol:{span:22,offset:2}},S.default.createElement(u.default,m,S.default.createElement(i.default,null,S.default.createElement(d.default,{type:"link",theme:"outlined"}),"\u589e\u52a0\u9644\u4ef6"))),S.default.createElement(P,{wrapperCol:{span:22,offset:2}},S.default.createElement(i.default,{type:"primary",htmlType:"submit"},"\u53d1\u9001"),S.default.createElement(i.default,{onClick:this.handleSaveDraft,style:{marginLeft:20}},"\u5b58\u8349\u7a3f"))))),S.default.createElement(r.default.Sider,{theme:"light",width:240},S.default.createElement(x.default,{handleChangeTo:this.handleChangeTo}))))}}]),t}(S.PureComponent))||E)||E),O=D;t.default=O},M1D9:function(e,t,a){"use strict";var n=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("O3gP");var l=n(a("lrIw")),r=n(a("RIqP"));a("Pwec");var o=n(a("CtXQ")),u=n(a("lwsE")),i=n(a("W8MJ")),d=n(a("a1gu")),c=n(a("Nsbk")),f=n(a("7W2i"));a("ozfa");var s,h,p=n(a("MJZm")),m=n(a("q1tI")),v=a("MuoO"),g=p.default.TreeNode,y=(s=(0,v.connect)(function(e){var t=e.frend,a=e.loading;return{frend:t,fetching:a.models.frend}}),s(h=function(e){function t(){var e,a;(0,u.default)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return a=(0,d.default)(this,(e=(0,c.default)(t)).call.apply(e,[this].concat(l))),a.state={checkedKeys:[],selectedKeys:[],searchData:[]},a.componentDidMount=function(){var e=a.props.dispatch;e({type:"frend/fetch",payload:{pageSize:100}})},a.onCheck=function(e){var t=a.props,n=t.handleChangeTo,l=t.frend.list,r=a.state.checkedKeys,o=e.filter(function(e){return-1===r.indexOf(e)}),u=r.filter(function(t){return-1===e.indexOf(t)}),i=l.filter(function(e){return-1!==o.indexOf(e.id.toString())}).map(function(e){return e.email}),d=l.filter(function(e){return-1!==u.indexOf(e.id.toString())}).map(function(e){return e.email});n(i,"add"),n(d,"del"),a.setState({checkedKeys:e})},a.onSelect=function(e,t){console.log("onSelect",t),a.setState({selectedKeys:e})},a.renderTreeNodes=function(e){return e.map(function(e){return e.children?m.default.createElement(g,{icon:m.default.createElement(o.default,{type:"team",theme:"outlined"}),title:e.name,key:e.id,dataRef:e},a.renderTreeNodes(e.children)):m.default.createElement(g,{icon:m.default.createElement(o.default,{type:"user",theme:"outlined"}),title:e.name,key:e.id,dataRef:e})})},a.handleSearch=function(e){var t=a.props.frend.list,n=t.filter(function(t){return t.name.indexOf(e)>-1}),l=n.map(function(e){return e.email});a.setState({searchData:l})},a.handleSelectSearch=function(e){var t=a.props,n=t.frend.list,l=t.handleChangeTo,o=a.state.checkedKeys,u=n.find(function(t){return t.email===e}),i=o.filter(function(e){return e===u.id});if(0===i.length){var d=(0,r.default)(o).concat([u.id]);a.setState({checkedKeys:d}),l(u.email,"add")}},a}return(0,f.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this.state,t=e.checkedKeys,a=e.selectedKeys,n=e.searchData,r=this.props.frend.list,o=[{name:"\u597d\u53cb",id:"all",children:r}];return m.default.createElement("div",{style:{paddingTop:10,paddingRight:10,maxHeight:600,overflowY:"auto",overflowX:"hidden"}},m.default.createElement(l.default,{dataSource:n,style:{width:"100%"},onSelect:this.handleSelectSearch,onSearch:this.handleSearch,placeholder:"search user"}),m.default.createElement(p.default,{checkable:!0,showIcon:!0,defaultExpandAll:!0,onCheck:this.onCheck,checkedKeys:t,onSelect:this.onSelect,selectedKeys:a},this.renderTreeNodes(o)))}}]),t}(m.default.Component))||h),C=y;t.default=C}}]);